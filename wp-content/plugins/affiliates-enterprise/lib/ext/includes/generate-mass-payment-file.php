<?php
if ( !defined( 'ABSPATH' ) ) { $IXAP218 = 'wp-load.php'; $IXAP33 = 100; while ( !file_exists( $IXAP218 ) && ( $IXAP33 > 0 ) ) { $IXAP218 = '../' . $IXAP218; $IXAP33--; } if ( file_exists( $IXAP218 ) ) { require_once $IXAP218; } } if ( defined( 'ABSPATH' ) ) { if ( !current_user_can( AFFILIATES_ACCESS_AFFILIATES ) ) { wp_die( __( 'Access denied.', AFFILIATES_PRO_PLUGIN_DOMAIN ) ); } else { if ( isset ( $_GET['action'] ) ) { global $wpdb, $affiliates_db; switch( $_GET['action'] ) { case 'generate_mass_payment_file' : if ( isset( $_GET['service'] ) ) { $params = array( 'tables' => array( 'referrals' => $affiliates_db->get_tablename( 'referrals' ), 'affiliates' => $affiliates_db->get_tablename( 'affiliates' ), 'affiliates_users' => $affiliates_db->get_tablename( 'affiliates_users' ), 'users' => $wpdb->users, ) ); $params = array_merge( $_GET, $params ); Affiliates_Totals::get_mass_payment_file( $_GET['service'], $params, get_option( 'blog_charset' ) ); die; } break; } } } }