!function(a){var b=function(b){var c=this;this.initialize_ui=function(){var a=b.$bundle_data.find(".wcsatt-options-wrapper");a.length>0&&(b.$addons_totals!==!1?b.$addons_totals.after(a):b.$bundle_price.after(a))},this.initialize_schemes=function(){b.satt_schemes=[];var c=b.$bundle_wrap.find(".wcsatt-options-product .subscription-option");a.each(c,function(c,d){var e=a(this),f=a(this).find("input").data("custom_data");b.satt_schemes.push({el:e,data:f})})},this.integrate=function(){c.initialize_ui(),c.initialize_schemes(),b.$bundle_data.on("woocommerce-product-bundle-updated-totals",c.update_subscription_totals)},this.update_subscription_totals=function(b,c){c.satt_schemes.length>0&&a.each(c.satt_schemes,function(b,d){if(1===c.satt_schemes.length&&0===c.$bundle_wrap.find(".wcsatt-options-product .one-time-option").length){var e=d.el.find(".subscription-details");c.$bundle_price.find(".price").append(e.clone())}else if(d.data.overrides_price===!0){var f=a.extend(!0,{},c.price_data);"inherit"===d.data.subscription_scheme.subscription_pricing_method&&d.data.subscription_scheme.subscription_discount>0?(a.each(c.bundled_items,function(a,b){var c=b.bundled_item_id;d.data.discount_from_regular?f.prices[c]=f.regular_prices[c]*(1-d.data.subscription_scheme.subscription_discount/100):f.prices[c]=f.prices[c]*(1-d.data.subscription_scheme.subscription_discount/100),f.addons_prices[c]=f.addons_prices[c]*(1-d.data.subscription_scheme.subscription_discount/100)}),f.base_price=f.base_price*(1-d.data.subscription_scheme.subscription_discount/100)):"override"===d.data.subscription_scheme.subscription_pricing_method&&(f.base_regular_price=Number(d.data.subscription_scheme.subscription_regular_price),f.base_price=Number(d.data.subscription_scheme.subscription_price)),f=c.calculate_subtotals(!1,f),f=c.calculate_totals(f);var g=c.get_price_html(f),h=d.el.find(".subscription-price");h.html(a(g).html()).find("span.total").remove(),h.trigger("wcsatt-updated-bundle-price",[g,d,c])}})},this.integrate()},c=function(b){var c=this;this.initialize_ui=function(){var a=b.$composite_data.find(".wcsatt-options-wrapper");a.length>0&&(b.composite_price_view.$addons_totals!==!1?b.composite_price_view.$addons_totals.after(a):b.$composite_price.after(a))},this.initialize_schemes=function(){b.satt_schemes=[];var c=b.$composite_data.find(".wcsatt-options-product .subscription-option");a.each(c,function(c,d){var e=a(this),f=a(this).find("input").data("custom_data");b.satt_schemes.push({el:e,data:f})})},this.integrate=function(){c.initialize_schemes(),b.actions.add_action("initialize_composite",function(){c.initialize_ui(),b.satt_schemes.length>0&&(b.satt_schemes.length>1||b.$composite_data.find(".composite_wrap .wcsatt-options-product .one-time-option").length>0?b.actions.add_action("composite_totals_changed",c.update_subscription_totals,101,c):b.filters.add_filter("composite_price_html",c.filter_price_html,10,c))},51,this)},this.filter_price_html=function(c,d,e){var f=b.satt_schemes[0].el.find(".subscription-details");return c=a(c).append(f.clone()).prop("outerHTML")},this.update_subscription_totals=function(){b.satt_schemes.length>0&&a.each(b.satt_schemes,function(c,d){if(d.data.overrides_price===!0){var e=a.extend(!0,{},b.data_model.price_data);"inherit"===d.data.subscription_scheme.subscription_pricing_method&&d.data.subscription_scheme.subscription_discount>0?(a.each(b.get_components(),function(a,b){var c=b.component_id;d.data.discount_from_regular?e.prices[c]=e.regular_prices[c]*(1-d.data.subscription_scheme.subscription_discount/100):e.prices[c]=e.prices[c]*(1-d.data.subscription_scheme.subscription_discount/100),e.addons_prices[c]=e.addons_prices[c]*(1-d.data.subscription_scheme.subscription_discount/100)}),e.base_price=e.base_price*(1-d.data.subscription_scheme.subscription_discount/100)):"override"===d.data.subscription_scheme.subscription_pricing_method&&(e.base_regular_price=Number(d.data.subscription_scheme.subscription_regular_price),e.base_price=Number(d.data.subscription_scheme.subscription_price)),e=b.data_model.calculate_subtotals(!1,e);var f=b.data_model.calculate_totals(e);e.totals=f;var g=b.composite_price_view.get_price_html(e),h=d.el.find(".subscription-price");h.html(a(g).html()).find("span.total").remove(),h.trigger("wcsatt-updated-composite-price",[g,d,b])}})},this.integrate()};a(".bundle_form .bundle_data").each(function(){a(this).on("woocommerce-product-bundle-initializing",function(a,c){c.is_composited()||new b(c)})}),a(".composite_form .composite_data").each(function(){a(this).on("wc-composite-initializing",function(a,b){new c(b)})})}(jQuery);